---
draft: false
aliases:
  - Beancount ä½¿ç”¨é—®é¢˜è®°å½•
  - beancount
number headings: auto, first-level 1, max 6, _.1.1
created: 2023-12-01 08:52
tags:
  - Software
shanghai: â˜€ï¸ ğŸŒ¡ï¸+4Â°C ğŸŒ¬ï¸â†˜22km/h
date: 2023-12-01 08:52:00
date modified: 2024-01-04 11:47:33
id: 20231201085304-64470873-0197-40b4-a223-85d062d72059
up: "[[ğŸ–¥ï¸ æ•°å­—ç”Ÿæ´» ğŸ’½]]"
---

## 1 ä¸ºä»€ä¹ˆä½¿ç”¨ beancount è®°è´¦ï¼Ÿ

### 1.1 å…¶ä»–è½¯ä»¶ä¸èƒ½æ»¡è¶³éœ€æ±‚

ä¸€å¼€å§‹æˆ‘ä¹Ÿå°è¯•äº†ä¸€äº›å…¶ä»–çš„è½¯ä»¶æ¯”å¦‚ [MoneyManager Ex -](https://moneymanagerex.org/)ï¼Œå†å°è¯•äº†å‡ å¤©ä¹‹åï¼Œæˆ‘å‘ç°ä»–å†è®°å½•è´¦æˆ·ä¹‹é—´çš„è½¬è´¦å’Œæ”¯å‡ºæ—¶æ¯”è¾ƒéº»çƒ¦ã€‚ä¸€ç¬”è½¬è´¦è¦åˆ†åˆ«å»ä¸¤ä¸ªè´¦æˆ·è®°å½•ä¸€æ¬¡ã€‚

å†åæ¥æˆ‘å°±çœ‹åˆ°äº†å¤å¼è®°è´¦è¿™ä¸ªæ–¹å¼ï¼Œæ„Ÿè§‰æ›´ç¬¦åˆæˆ‘çš„éœ€æ±‚ã€‚ä¸€å¼€å§‹é€‰æ‹©çš„å¤å¼è®°è´¦è½¯ä»¶ä¹Ÿä¸æ˜¯ beancountï¼Œè€Œæ˜¯ [Free Accounting Software | GnuCash](https://www.gnucash.org/)ã€‚
![Screenshot2024001004011023028](https://pic.237484.xyz/uPic/Screenshot2024001004011023028.png)
ä»–çš„è½¯ä»¶ UI è®©æˆ‘æœ‰ç‚¹æ—¶å…‰ç©¿æ¢­çš„æ„Ÿè§‰ï¼Œç”¨äº†å¾ˆçŸ­çš„æ—¶é—´æˆ‘å°±æ”¾å¼ƒäº†ã€‚è½¯ä»¶çš„ UI äº¤äº’é€»è¾‘éƒ½å¾ˆéš¾ä»¥ç†è§£ã€‚

### 1.2 æ•°æ®æ ¼å¼ä¸é€šç”¨

æ¯ä¸€ä¸ªè®°è´¦è½¯ä»¶éƒ½ç”¨äº†ä¸åŒçš„æ•°æ®æ ¼å¼ï¼Œåœ¨å¯¼å…¥å¤–éƒ¨æ•°æ®æ—¶ï¼Œåªæœ‰ [MoneyManager Ex -](https://moneymanagerex.org/) è¿˜ç®—æ¯”è¾ƒå¥½ç”¨ã€‚
å°¤å…¶æ˜¯åœ¨æ‰¹é‡ä¿®æ”¹è®°å½•æ—¶éå¸¸ä¸æ–¹ä¾¿ã€‚

## 2 è´¦æˆ·æ ¼å¼é—®é¢˜

beancount è´¦æˆ·æ ¼å¼è¦æ±‚äºŒçº§è´¦æˆ·å¿…é¡»å¤§å†™è‹±æ–‡å­—æ¯å¼€å¤´ï¼Œè‡³äºè‹±æ–‡å­—æ¯åé¢çš„å­—ç¬¦å…¶å®æ˜¯æ²¡æœ‰é™åˆ¶çš„ã€‚æœ€æœ«çº§çš„è´¦æˆ·æ˜¯æ²¡æœ‰é™åˆ¶çš„å®Œå…¨å¯ä»¥å†™ä¸­æ–‡è´¦æˆ·ã€‚

æˆ‘ä¸å»ºè®®ç”¨ä¸­æ–‡è´¦æˆ·åç§°ï¼Œå› ä¸ºåœ¨ VSCode ä¸­ä¸­æ–‡å­—ç¬¦æ— æ³•è‡ªåŠ¨å¡«å……ã€‚

## 3 Beancount å¦‚ä½•å¤„ç†å°¾å·®

åœ¨æƒç›Šè´¦æˆ·ä¸­å¢åŠ ä¸€ä¸ª Rounding è´¦æˆ·ï¼Œåœ¨è´­ä¹°åŸºé‡‘ã€è‚¡ç¥¨æ—¶å¦‚æœæœ‰å°¾å·®ï¼Œå°±æŠŠå°¾å·®å¹¶å…¥åˆ°è¿™ä¸ªç§‘ç›®ä¸­ï¼Œä»¥ä¾¿ä¿æŒè´¦æˆ·ä¹‹é—´çš„å¹³è¡¡ã€‚

## 4 å¦‚ä½•å¤„ç†æ˜¾ç¤ºç²¾åº¦ï¼Ÿ

ä¸çŸ¥é“ï¼Œåœ¨ç½‘ä¸Šçœ‹åˆ°ä¸€ç§è¯´æ³•æ˜¯åœ¨è¾“å…¥æ—¶ä¿æŒéœ€è¦çš„å°æ•°ç‚¹ç²¾åº¦ï¼Œä¹Ÿæœ‰è¯´æ³•æ˜¯ç›´æ¥ä½¿ç”¨ custom æŒ‡ä»¤æ¥æŒ‡å®šå…·ä½“çš„å•†å“ç²¾åº¦ã€‚æˆ‘æ„Ÿè§‰æ²¡å•¥ç”¨ã€‚åœ¨å®˜æ–¹çš„æ–‡æ¡£ä¸­ä¹Ÿæ²¡æœ‰æ‰¾åˆ°ç‰¹åˆ«é è°±çš„è¯´æ³•ã€‚
~~åœ¨æŸä¸€æ¬¡å¯åŠ¨ä¹‹åï¼Œæ˜¾ç¤ºäº†å¯¹åº”çš„è´¦æˆ·çš„ç›ˆä½™æ•°æ®ï¼Œä½†ä¹Ÿä»…æ­¤ä¸€æ¬¡ã€‚å†æ¬¡å¯åŠ¨çš„æ—¶å€™å°±çœ‹ä¸åˆ°äº†ã€‚åˆæ¢å¤åˆ°äº† 2 ä½å°æ•°ã€‚~~

> [!tip] 2023-12-04 11:07 æ›´æ–°
> è°ƒæ•´è¾“å…¥çš„å°æ•°ä½æ•°æ˜¯æœ‰æ•ˆæœçš„ï¼Œä½†æ˜¯ä¹Ÿæ²¡æœ‰èƒ½æŠŠæ”¶ç›Šç›´æ¥ä½“ç°åœ¨èµ„äº§è´Ÿå€ºè¡¨ä¸Šã€‚

> [!tip] 2024-01-03 12:26 æ›´æ–°
> å…¶å®æ˜¯æˆ‘æ²¡æœ‰è®¾ç½®å¥½ï¼Œåœ¨ fava çš„å³ä¸Šè§’çš„ä¸‹æ‹‰é€‰æ‹©ä¸­é€‰ä¸º `å¸‚ä»·`ï¼Œå°±å¯ä»¥æ˜¾ç¤ºæ”¶ç›Šå€¼ã€‚

## 5 å¦‚ä½•è®°å½•å‘¨æœŸè´¦å•ğŸ§¾ï¼Ÿ

~~æœ‰ä¸€ä¸ªå‘¨æœŸè´¦å•çš„æ’ä»¶ï¼Œä½†æ˜¯å…¶å®å¹¶ä¸å¥½ç”¨ã€‚~~å› ä¸ºä»–æ˜¯ä¸€æ¡è§„åˆ™ï¼Œåªä¼šåœ¨ fava ä¸­æ˜¾ç¤ºä¸€æ‰¹è™šæ‹Ÿçš„äº¤æ˜“è®°å½•ï¼Œåœ¨å®é™…çš„è´¦æˆ·è®°å½•ä¸Šæ˜¯æ²¡æœ‰çš„ã€‚ä½†ä¹Ÿä¼šç«‹å³è®¡å…¥èµ„äº§è´Ÿå€ºè¡¨ä¸­ã€‚

å¯¹äºè¿™ç§è®°å½•ï¼Œå¦‚æœä¸´æ—¶è°ƒæ•´äº†è´¦å•çš„å‘¨æœŸï¼Œä¹‹å‰çš„è®°å½•å°±ä¼šå‡ºç°é—®é¢˜ã€‚æ¯”å¦‚åˆ†æœŸä»˜æ¬¾äº† 12 æœŸï¼Œæœ€å 3 æœŸä¸€æ¬¡æ€§ä»˜å®Œäº†ã€‚å°±éœ€è¦å»è°ƒæ•´ä¹‹å‰è®¾ç½®å‘¨æœŸè´¦å•è§„åˆ™ã€‚

> [!tip] 2023-12-14 16:16
> æˆ‘å‘ç°è¿™ä¸ªæ’ä»¶ç”¨æ¥è®¡ç®—åˆ©æ¯å’Œåˆ†æœŸä»˜æ¬¾çš„è´¦å•è¿˜æ˜¯å¾ˆä¸é”™çš„ã€‚

ä»–çš„è¯­æ³•ç¤ºä¾‹æ˜¯è¿™æ ·çš„ã€‚

```lisp
2023-12-29 # "å€Ÿæ¬¾åˆ©æ¯ [DAILY UNTIL 2024-01-10]"
	Expenses:Interest:XXXX (10000 * 0.0003) CNY
	Liabilities:CreditCard:XXXX
```

## 6 å¦‚ä½•è®¾ç½®é¢„ç®—ï¼Ÿ

fava æœ‰ä¸€ä¸ªé¢„ç®—è®¾ç½®å‘½ä»¤ï¼Œåœ¨å¸®åŠ©æ–‡æ¡£ä¸­æœ‰è¯¦ç»†çš„è¯´æ˜ã€‚æ¯”è¾ƒç®€å•ã€‚

```lisp
2024-01-01 custom "budget" Expenses:HouseholdBills:Internet "yearly" 1200.00 CNY ;å®½å¸¦é¢„ç®—1å¹´1200å…ƒ

2024-01-01 custom "budget" Expenses:Car:CommuteParking "monthly" 300.00 CNY ;é€šå‹¤åœè½¦ä½ æ¯ä¸ªæœˆ300å…ƒ

2024-01-01 custom "budget" Expenses:Car:Charging "monthly" 300.00 CNY ;æ¯ä¸ªæœˆæ±½è½¦å……ç”µè´¹300å…ƒ

2024-01-01 custom "budget" Expenses:Car:TemporaryParking "monthly" 100.00 CNY ; æ¯ä¸ªæœˆä¸´æ—¶åœè½¦è´¹ 100

2024-01-01 custom "budget" Expenses:Personal:Clothing "monthly" 50.00 CNY ; æ¯ä¸ªæœˆæœè£…è´¹ 50

2024-01-01 custom "budget" Expenses:Personal:Haircut "monthly" 50.00 CNY ;æ¯ä¸ªæœˆç†å‘ 50

2024-01-01 custom "budget" Expenses:Personal:Coffice "quarterly" 400.00 CNY ;æ¯3ä¸ªæœˆå’–å•¡è±† 

2024-01-01 custom "budget" Expenses:HouseholdBills:Property "yearly" 3124.00 CNY ;ç‰©ä¸šè´¹
```

## 7 ä¿¡å°å¼é¢„ç®—æ’ä»¶

> [!tip] 2024-01-01 11:00
> ä¿¡å°å¼é¢„ç®—ï¼Œä¸å¤ªå¥½ç”¨ã€‚æˆ‘æœ‰ç‚¹ç†è§£ä¸äº†è¿™ä¸ªé¢„ç®—é€»è¾‘ã€‚

[polarmutex/fava-envelope: A beancount fava extension to add a envelope budgeting capability (github.com)](https://github.com/polarmutex/fava-envelope)

å®‰è£…å‘½ä»¤ `pip install fava-envelope`

## 8 å¦‚ä½•è®°å½•è´­ç‰©é€€æ¬¾ï¼Ÿ

åŸè·¯é€€å›å³å¯ã€‚

## 9 å¦‚ä½•å…³è”å…¶ä»–æ–‡ä»¶

ä½¿ç”¨ include å‘½ä»¤å¯ä»¥å…³è”å…¶ä»–æ–‡ä»¶ï¼Œä½†æ˜¯åœ¨è¡¨ç¤ºç›¸å¯¹è·¯å¾„æ—¶ï¼Œéœ€è¦æ³¨æ„è¦ä½¿ç”¨ `../å­æ–‡ä»¶å¤¹/XXX.beancount` è¿™ç§è¯­æ³•æ¥è¡¨ç¤ºã€‚

å¦‚æœè¦å…³è”ä¸€ä¸ªç‰¹å®šæ ¼å¼çš„è´¦æœ¬æ–‡ä»¶ï¼Œæ¯”å¦‚è¿™æ ·çš„

```
2023-01.beancount 
2023-02.beancount 
â€¦â€¦
2023-12.beancount 
```

åˆ™å¯ä»¥ä½¿ç”¨æ›´ç®€æ´çš„æ–¹æ³•å…³è” `include "2023-*.beancount"`

## 10 å¦‚ä½•åŒæ­¥æ•°æ®ï¼Ÿ

æˆ‘æ˜¯ç”¨ GitHub çš„ç§äººä»“åº“æ¥åŒæ­¥æ•°æ®ï¼Œæˆ‘è§‰å¾—è¿˜æ˜¯æŒºæ–¹ä¾¿çš„ã€‚å”¯ä¸€çš„é—®é¢˜æ˜¯åœ¨ç§»åŠ¨ç«¯ä¸å¤ªå¥½è®°å½•è¿™äº›æ•°æ®ã€‚

## 11 å¦‚ä½•åˆ†ç±»è®°å½•è´¦å•ï¼Ÿ

1. å¯ä»¥ä½¿ç”¨å•ç‹¬çš„æ–‡ä»¶æ¥è®°å½•ï¼Œæ¯”å¦‚ `2023travel-beijing.beancount`
2. ä¹Ÿå¯ä»¥åœ¨æ—¥å¸¸çš„è´¦æœ¬æ–‡ä»¶ä¸­ä½¿ç”¨ æ ‡ç­¾å †å çš„æ–¹æ³•æ¥è®°å½•ã€‚[^1] åœ¨ `pushtag` å’Œ `poptag` ä¹‹é—´çš„æ‰€æœ‰äº¤æ˜“è®°å½•éƒ½ä¼šè‡ªåŠ¨æ‰“ä¸Šè¿™æ ·çš„æ ‡ç­¾ã€‚è¿™æ ·çš„æ–¹æ³•ç”¨èµ·æ¥æ¯”è¾ƒè‡ªç”±

```lisp
pushtag #berlin-trip-2014 

2014-04-23 * "Flight to Berlin" 
	Expenses:Flights -1230.27 USD 
	Liabilities:CreditCard 
	
poptag #berlin-trip-2014
```

## 12 å¦‚ä½•æ·»åŠ è´­ç‰©å‡­è¯ï¼ˆå‘ç¥¨ğŸ§¾ï¼‰ï¼Ÿ

1. æ‰‹åŠ¨æ·»åŠ å‡­è¯çš„è¯­æ³• `2013-11-03 document Liabilities:CreditCard "/home/joe/stmts/apr-2014.pdf"`
2. è‡ªåŠ¨å…³è”ï¼Œåˆ™éœ€è¦ç”¨æˆ·æŒ‰ç…§æ–‡æ¡£é‡Œçš„è§„åˆ™ï¼Œåˆ›å»ºå¯¹åº”è´¦æˆ·çš„ç»“æ„å’Œæ—¥æœŸå‘½åçš„è§„åˆ™ã€‚å—¯ å¯ä»¥ä½¿ç”¨
3. åœ¨ fava ä¸­æ‰“å¼€å¯¹åº”çš„è´¦æˆ·ï¼Œç›´æ¥åœ¨æŠŠå‡­è¯æ–‡ä»¶æ‹–å…¥åˆ° web é¡µé¢ä¸­ï¼Œä¿®æ”¹ä¸€ä¸‹æ–‡ä»¶åç§°å°±å¯ä»¥è‡ªåŠ¨åˆ›å»ºå¯¹åº”çš„è´¦æˆ·æ–‡ä»¶å¤¹äº†ã€‚ğŸ‘

## 13 å¦‚ä½•è®°å½•åˆ†æ‹…è´¹ç”¨ (AA)ï¼Ÿ

æˆ‘ç°åœ¨åº”è¯¥æ˜¯ç”¨ä¸åˆ°è¿™ä¸ªæ’ä»¶äº†ï¼Œä¸è¿‡å¦‚æœéœ€è¦çš„è¯ï¼Œå¯ä»¥å®‰è£…è¿™ä¸ªæ’ä»¶è¯•ä¸€è¯•ã€‚[Akuukis/beancount_shareï¼šä¸€ä¸ª beancount æ’ä»¶ï¼Œç”¨äºåœ¨ä¸€ä¸ªè´¦æœ¬ä¸­ä¸å¤–éƒ¨åˆä½œä¼™ä¼´åˆ†æ‹…è´¹ç”¨ã€‚ (github.com)](https://github.com/Akuukis/beancount_share)

## 14 å¦‚ä½•æŠ¹é™¤å¯¹è´¦æ—¶çš„å°‘é‡ğŸ¤å·®é¢ï¼Ÿ

ä½¿ç”¨ `pad` å‘½ä»¤æŠŠéœ€è¦æŠ¹é›¶çš„è´¦æˆ· ç›´æ¥è½¬åˆ° æ‰€æœ‰è€…æƒç›Šè´¦æˆ·ã€‚

## 15 å¦‚ä½•ä½¿ç”¨ Fava çš„ç»Ÿè®¡é¡µé¢çš„ Copy balance directivesï¼Ÿ

![Screenshot2024001004011007057](https://pic.237484.xyz/uPic/Screenshot2024001004011007057.png)
<center>Copy balance directives </center>

åº”è¯¥åœ¨è´¦æˆ·å¼€æˆ·çš„å‘½ä»¤ä¸‹å¢åŠ ä¸€ä¸ªå…ƒæ•°æ®ï¼Œ`fava-uptodate-indication: "True"`ï¼Œè¿™æ ·æ‰èƒ½æ­£å¸¸å¤åˆ¶ blance å‘½ä»¤ã€‚[^2]ã€‚

å…³äºè¿™ä¸ªå…ƒæ•°æ®çš„ä½¿ç”¨æ–¹æ³•å…¶å®åœ¨å¸®åŠ©æ–‡æ¡£ä¸­æœ‰å†™ï¼Œä½†æ˜¯å½“æ—¶æˆ‘çœ‹çš„æ—¶å€™ï¼Œå®Œå…¨æ²¡æœ‰æ„è¯†åˆ°è¿™ä¸ªå…ƒæ•°æ®è·Ÿ `Copy balance directives` æŒ‰é’®æœ‰ä»€ä¹ˆå…³ç³»ã€‚

> [!help]+  Up-to-date indicatorsÂ æœ€æ–°æŒ‡æ ‡
> Fava offers colored indicators that can help you keep your accounts up-to-date. They are shown next to accounts that have the metadataÂ set on their Open directive. The colors have the following meaning: `fava-uptodate-indication: TRUE`
> Fava æä¾›äº†å½©è‰²æŒ‡ç¤ºå™¨ï¼Œå¯ä»¥å¸®åŠ©æ‚¨ä¿æŒè´¦æˆ·çš„æœ€æ–°çŠ¶æ€ã€‚å®ƒä»¬æ˜¾ç¤ºåœ¨å·²è®¾ç½®äº† Open æŒ‡ä»¤å…ƒæ•°æ®çš„è´¦æˆ·æ—è¾¹ã€‚é¢œè‰²çš„å«ä¹‰å¦‚ä¸‹ï¼šÂ `fava-uptodate-indication: TRUE`
> - green: The last entry for this account is a balance check that passed.
	> ç»¿è‰²ï¼šæ­¤è´¦æˆ·çš„æœ€åä¸€ç¬”è®°å½•æ˜¯ä¸€æ¬¡é€šè¿‡çš„ä½™é¢æŸ¥è¯¢ã€‚
> - red: The last entry is a balance check that failed.
	> çº¢è‰²ï¼šæœ€åä¸€æ¡è®°å½•æ˜¯ä¸€æ¬¡å¤±è´¥çš„ä½™é¢æ£€æŸ¥ã€‚
> - yellow: The last entry is not a balance check.
	> é»„è‰²ï¼šæœ€åä¸€é¡¹ä¸æ˜¯ä½™é¢æŸ¥è¯¢ã€‚
In addition, a grey dot will be shown if the account has not been updated in a while, as configured by theÂ option.`uptodate-indicator-grey-lookback-days`
æ­¤å¤–ï¼Œå¦‚æœè´¦æˆ·å·²ç»æœ‰ä¸€æ®µæ—¶é—´æ²¡æœ‰æ›´æ–°ï¼Œæ ¹æ®é€‰é¡¹çš„é…ç½®ï¼Œå°†æ˜¾ç¤ºä¸€ä¸ªç°è‰²çš„ç‚¹ã€‚

æ–‡æ¡£é‡Œè¿™å¥ "In addition, a grey dot will be shown if the account has not been updated in a while, as configured by theÂ option.`uptodate-indicator-grey-lookback-days` "
å¯ä»¥åœ¨ä¸»è´¦æœ¬ä¸­æ·»åŠ ä¸€ä¸ªè¿™æ ·çš„è®¾ç½®å°±å¥½äº†ã€‚

> [!note]+
> `2023-12-22 custom "fava-option" "uptodate-indicator-grey-lookback-days" "10"

10 ä»£è¡¨çš„å¤©æ•°ã€‚
è¿™æ ·è®¾ç½®å®Œæˆä¹‹åï¼Œå°±å¯ä»¥åœ¨ fava é¡µé¢ä¸­çœ‹åˆ°æ¯ä¸ªè´¦æˆ·å³ä¾§å¤šäº†ä¸€ä¸ªçŠ¶æ€æ ‡è¯†ã€‚

## 16 å¦‚ä½•è®°å½•æŠ˜æ—§ï¼Ÿ

æˆ‘æ”¾å¼ƒç ”ç©¶æŠ˜æ—§äº†ï¼ŒæŠ˜æ—§å¯¹äºæ—¥å¸¸ç”Ÿæ´»è®°è´¦ä¼¼ä¹æ²¡æœ‰å®é™…æ„ä¹‰ã€‚

## 17 æ ¼å¼åŒ–è´¦æœ¬

> [!tip] 2024-01-04
> æ ¼å¼åŒ–äº†ä¸€ä¸ªæœˆçš„è´¦æœ¬ä¹‹åï¼Œæ„Ÿè§‰å¹¶ä¸å¾ˆå¥½ç”¨ï¼Œå°¤å…¶æ˜¯è´¦æœ¬ä¸­æœ‰ä¸€äº›å››åˆ™è¿ç®—ç¬¦çš„æ—¶å€™ï¼Œæ ¼å¼åŒ–æ•ˆæœå¾ˆç³Ÿç³•ã€‚

[LaunchPlatform/beancount-black: Opinionated code formatter, just like Python's black code formatter but for Beancount (github.com)](https://github.com/LaunchPlatform/beancount-black)

## 18 å…¶ä»–æ’ä»¶

è¿˜æ²¡æœ‰å°è¯•å…¶ä»–çš„æ’ä»¶ã€‚

[^1]: [Beancount è¯­è¨€è¯­æ³• - Beancount æ–‡æ¡£](https://beancount.github.io/docs/beancount_language_syntax.html#the-tag-stack)
[^2]: https://github.com/beancount/fava/issues/908#issuecomment-489360641
